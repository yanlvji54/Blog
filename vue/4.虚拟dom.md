# 虚拟 dom

为什么需要虚拟 dom？ 虚拟 dom 解决了什么痛点？

## 虚拟 dom 本质

为什么需要虚拟 dom？ 为了尽可能的减少重绘机制

对于将一个数组转化为一个列表信息
如果出现了数组中某一个数字的改动
常规做法是将其再绘制一次，那么对于大型服务应用，这种产生的性能开销是不可接受的
如果将其优化，单次、排序、倒转、删除、增加等等情况，都需要给其做相应的优化。

优化即对比，对比原来的情况，判定哪些过程是需要更新，本质也是虚拟 dom 做的事。因为在正常的更新对比中，是不可以利用真实 dom 对象的，因为真实 dom 对象很大，对比之下，虚拟 dom 是解决方案之一。

## patch 算法

对比前后两个虚拟 dom
设定两个指针，同时指向头部节点，之后对比节点的数据，互相对比数据，如果不同则触发更新逻辑，之后开始循环 children，一步步对比子节点，如果不同则触发更新。
每一个节点都是带有一个 id 值的，优先对比的是 id 值
patch 节点还会有更新优化逻辑，
即对比到指针不同的情况下，会去找新头，新尾，旧头，旧尾的区别， 以处理插入，倒转的情况。

一个小细节，更新的节点需要插入到未处理的第一个位置，用于更新不会错位
